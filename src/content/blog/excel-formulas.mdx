---
title: Formule Excel più utili
pubDate: 2023-11-27 19:01
author: 'u/InvestitoreComune'
tags:
  - Wiki IPF
  - Risorse Utili
imgUrl: '../../assets/excel.jpg'
description: Excel è uno dei tool più utilizzati per la gestione di portafogli e per il calcolo di rendimenti e volatilità. In questo articolo troverai le formule più utili per il tuo portafoglio.
layout: '../../layouts/BlogPost.astro'
slug: formule-utili-excel
lastReviewer: 'u/InvestitoreComune'
---

# Formule Excel più utili

## Calcolo del Valore Futuro con la Funzione FV()
La funzione Future Value (**FV()**), o **VAL.FUT()** in italiano per chi utilizza Excel, 
consente di stimare il valore futuro di un investimento o di un finanziamento con un tasso di interesse costante e pagamenti periodici regolari. 
Ad esempio, se vogliamo calcolare il valore futuro di un investimento di 1.200 euro annuale per 20 anni con un tasso di interesse del 6% annuale, la formula in Excel sarà:

```
=FV(tasso; nper; pagamento; valore_attuale; tipo)
```

Dove:

- tasso: il tasso di interesse per ogni periodo.

- nper: il numero totale di periodi.

- pagamento: il pagamento effettuato in ciascun periodo; deve rimanere costante durante tutti i periodi.

- valore_attuale: il valore attuale o l'importo di un prestito o di un investimento iniziale.

- tipo: indica se i pagamenti sono dovuti all'inizio o alla fine del periodo; 0 se alla fine, 1 se all'inizio.

Nel nostro esempio, la formula sarà:
=FV(6%; 20; -1200; 0; 0)
Il risultato sarà il valore futuro dell'investimento dopo 20 anni, che, come indicato, è di 44.143 euro.

Per calcolare il valore futuro con versamenti mensili, è necessario adattare la formula. 
Se i versamenti sono mensili, il tasso di interesse e il numero totale di periodi devono essere convertiti in base mensile. 
Ad esempio, se il tasso di interesse annuale è del 6%, il tasso mensile sarà 0,5% (6% diviso per 12). Il numero totale di periodi sarà il numero di anni moltiplicato per 12.

```
=FV(0,5%; 20*12; -100; 0; 0)
```
In questo caso, si moltiplica il versamento annuale per 12 (-100, assumendo che il versamento mensile sia di 100 euro). 
La formula restituirà il valore futuro dell'investimento con versamenti mensili.


## Attualizzazione del Valore Futuro con la Funzione PV()
La funzione Present Value (**PV()**), o **VA()** in italiano per chi utilizza Excel, permette di attualizzare il valore di un investimento futuro, 
indicando quanto dovrebbe essere investito oggi per ottenere un determinato capitale in futuro, considerando un tasso di interesse costante.

La formula in Excel è:

```
=PV(tasso; nper; pagamento; valore_futuro; tipo)
```

Dove:
- tasso: il tasso di interesse per ogni periodo.

- nper: il numero totale di periodi.

- pagamento: il pagamento effettuato in ciascun periodo; deve rimanere costante durante tutti i periodi.

- valore_futuro: il valore futuro desiderato.

- tipo: indica se i pagamenti sono dovuti all'inizio o alla fine del periodo; 0 se alla fine, 1 se all'inizio.

Nell’ esempio, se volessimo ottenere un capitale di 100.000 euro tra 20 anni con un tasso di interesse annuale del 6%, la formula sarebbe:
=PV(6%; 20; 0; -100000; 0)

Il risultato sarebbe il valore attuale, ovvero quanto dovremmo investire oggi, che nel caso specifico è di 31.180 euro.

Se ipotizziamo versamenti periodici per raggiungere l'obiettivo di 100.000 euro, 
possiamo utilizzare la funzione **PMT()** per calcolare il pagamento necessario in ogni periodo. 
Tuttavia, in questo caso, la formula richiede di conoscere in anticipo la durata del pagamento, il tasso di interesse e il valore futuro desiderato. La formula sarà simile a questa:

```
=PMT(tasso; nper; 0; -100000; 0)
```

Dove i parametri sono simili a quelli della funzione PV(), con l'aggiunta di un pagamento (0 in questo caso). 
La formula restituirà il pagamento periodico necessario per raggiungere l'obiettivo.


## Utilizzo della Funzione PMT() per Calcolare Rate

La funzione **PMT()**, o **RATA()** in italiano per chi utilizza Excel, 
è uno strumento versatile per calcolare rate per finanziamenti o premi periodici per raggiungere un determinato capitale in futuro.

La formula in Excel è:

```
=PMT(tasso; nper; valore_attuale; valore_futuro; tipo)
```

Dove:

- tasso: il tasso di interesse per ogni periodo.

- nper: il numero totale di periodi.

- valore_attuale: il valore attuale o l'importo di un prestito o di un investimento iniziale.

- valore_futuro: il valore futuro desiderato.

- tipo: indica se i pagamenti sono dovuti all'inizio o alla fine del periodo; 0 se alla fine, 1 se all'inizio.

Se desideri ottenere un capitale di 100.000 euro in 20 anni con un tasso di interesse annuale del 4%, la formula sarà:
```
=PMT(4%; 20; 0; -100000; 0)
```

Questa formula calcolerà la rata annuale necessaria per raggiungere l'obiettivo. 

Se desideri convertire questa rata in dati mensili, puoi fare come segue:
```
=PMT(4%/12; 20*12; 0; -100000; 0)
```

In questo caso, il tasso di interesse annuale è diviso per 12 e il numero totale di periodi è moltiplicato per 12. 
La formula restituirà la rata mensile necessaria. 
È importante notare che la rata mensile sarà leggermente diversa da quella annuale a causa del diverso metodo di calcolo degli interessi (annuale vs mensile).

La funzione PMT() è strumentale per stimare pagamenti periodici, ad esempio per un piano di accumulo (PAC), o per calcolare la rata di un mutuo o finanziamento a tasso fisso.


## Calcolo del Tasso Interno di Rendimento (TIR) con XIRR()
La funzione **XIRR()**, o **TIR.X()** in italiano per chi utilizza Excel, 
è uno strumento potente per calcolare il tasso interno di rendimento (IRR - Internal Rate of Return).
 È particolarmente utile per il calcolo dei rendimenti su flussi di cassa con date non necessariamente periodiche.

La formula in Excel è:
```
=XIRR(valori; date; [tasso_ottenuto])
```

Dove:

- valori: la serie di flussi di cassa.

- date: la serie di date corrispondenti ai flussi di cassa.

- tasso_ottenuto: (opzionale) il tasso di rendimento stimato iniziale.

Ad esempio, se si vogliono calcolare i rendimenti su un investimento che ha flussi di cassa non periodici, la formula può apparire così:
```
=XIRR({-1000; 100; 200; 300; 400}, {"01/01/2022"; "02/15/2022"; "05/20/2022"; "09/10/2022"; "12/31/2022"})
```

Questa formula restituirà il tasso interno di rendimento per gli investimenti indicati nei flussi di cassa nelle date specificate.

La funzione XIRR() è estremamente utile per calcolare il rendimento lordo e netto di obbligazioni, il rendimento medio annuale di un portafoglio, 
o il rendimento di un portafoglio con versamenti o disinvestimenti periodici. 

Il risultato ottenuto applicando questa formula rappresenta il tasso di rendimento interno modificato (**MWRR - Modified Weigthed Rate of Return**).


## Calcolo del Tasso di Interesse con la formula RATE()
La funzione **RATE()**, o **TASSO()** in italiano per gli utenti di Excel, è uno strumento cruciale nella pianificazione finanziaria. 
Questa formula consente di calcolare il tasso di interesse necessario per raggiungere un determinato obiettivo finanziario entro un periodo di tempo specifico.

La formula in Excel è:
```
=RATE(num_rate; rata; valore_attuale; [valore_futuro]; [tipo]; [stima])
```

Dove:

- num_rate: il numero totale di periodi di pagamento.

- rata: la rata di pagamento periodica, costante nel tempo.

- valore_attuale: il valore presente o l'investimento iniziale.

- valore_futuro: (opzionale) il valore futuro desiderato o l'importo finale.

- tipo: (opzionale) indica se i pagamenti sono dovuti all'inizio (tipo = 1) o alla fine (tipo = 0) del periodo.

- stima: (opzionale) la stima iniziale del tasso di interesse.


Ad esempio, se si prevede di risparmiare 100.000 euro in 10 anni e si vuole calcolare il tasso di interesse necessario 
per raggiungere questo obiettivo con pagamenti annuali di 8.000 euro, la formula può apparire così:

```
=RATE(10; -8000; 0; 100000)
```

Questa formula restituirà il tasso di interesse necessario per raggiungere l'obiettivo specificato.

L'utilizzo della funzione RATE() è prezioso per valutare la fattibilità dei piani finanziari. 
Se il tasso di interesse risultante è irrealistico, può indicare la necessità di rivedere gli obiettivi finanziari o di considerare approcci di investimento più adatti alla propria situazione.



## Calcolo del Numero di Versamenti con la formula NPER()

La funzione **NPER()**, o **NUM.RATE()** in italiano per gli utenti di Excel, è un potente strumento per determinare
 il numero di periodi necessari per raggiungere un obiettivo finanziario specifico considerando tassi di interesse e versamenti periodici costanti.

La formula in Excel è:

```
=NPER(tasso; rata; valore_attuale; [valore_futuro]; [tipo])
```

Dove:
- tasso: il tasso di interesse per ciascun periodo.

- rata: la rata di pagamento periodica, costante nel tempo.

- valore_attuale: il valore presente o l'investimento iniziale.

- valore_futuro: (opzionale) il valore futuro desiderato o l'importo finale.

- tipo: (opzionale) indica se i pagamenti sono dovuti all'inizio (tipo = 1) o alla fine (tipo = 0) del periodo.


Ad esempio, se si desidera calcolare quanti anni sono necessari per saldare un debito di 100.000 euro versando 12.000 euro all'anno con un tasso di interesse del 5%, 
la formula può apparire così:

```
=NPER(5%; -12000; 0; 100000)
```

Questa formula restituirà il numero di periodi (anni, in questo caso) necessari per raggiungere l'obiettivo specificato.

È importante notare che la coerenza delle unità di tempo è cruciale quando si utilizza questa formula. 
Se si usa un tasso di interesse annuale, è necessario fornire versamenti annuali e viceversa. 

Mensilizzando tasso di interesse e versamenti periodici possiamo anche stimare il numero di mesi che servono ad arrivare all’obiettivo. 
Fate molta attenzione quando utilizzate i valori mensili perché se il periodo è inferiore all’anno, 
vengono fatte delle assunzioni da Excel stesso che ipotizzano quel trend di andamento costante per tutto l’anno. 
Inoltre, fate attenzione a mensilizzare tutti i parametri: 
se impostate versamenti periodici a 1000 € ma interesse al 5% state stimando di ripagare un finanziamento per il quale versate 1000 euro al mese con un tasso MENSILE del 5%.


## Calcolo della Duration di un'Obbligazione con la Formula DURATA()
La duration di un'obbligazione è una misura che esprime il tempo medio ponderato necessario per recuperare l'investimento attraverso i flussi di cassa generati dall'obbligazione, 
inclusi i pagamenti periodici di cedole e il rimborso del capitale alla scadenza. 
Questa misura è cruciale per stimare l'impatto delle variazioni dei tassi di interesse sul prezzo di mercato dell'obbligazione.

In Excel, la formula per calcolare la duration di un'obbligazione è **DURATA()**.

```
=DURATA(data_acquisto; data_scadenza; tasso_cedola; tasso_di_mercato; [frequenza_cedola]; [tipo])
```

Dove:

- data_acquisto: la data di acquisto dell'obbligazione.

- data_scadenza: la data di scadenza dell'obbligazione.

- tasso_cedola: il tasso di cedola annuale dell'obbligazione.

- tasso_di_mercato: il tasso di interesse corrente sul mercato.

- frequenza_cedola: (opzionale) la frequenza dei pagamenti di cedola all'anno (1 = annuale, 2 = semestrale, 4 = trimestrale).

- tipo: (opzionale) indica se i pagamenti di cedola sono dovuti all'inizio (tipo = 1) o alla fine (tipo = 0) del periodo.


La duration così calcolata rappresenta il numero medio di periodi necessari per il recupero dell'investimento. 
Tuttavia, per valutare l'effetto delle variazioni dei tassi di interesse, è spesso più utile considerare la duration modificata.

### Calcolo della Duration Modificata:
La duration modificata è calcolata con la formula:

![Duration Modificata](https://latex.codecogs.com/svg.image?&space;durationModificata=\frac{duration}{(1&plus;rendimento)})

La duration modificata tiene conto del fatto che le variazioni percentuali dei tassi di interesse 
influiscono diversamente sul prezzo dell'obbligazione in base al suo tasso di cedola.

Esempio:

|Rendimento/Durate|Lordo|Netto|Netto senza CG|
|:-|:-|:-|:-|
|Rendimento|4,44%|3,88%|3,89%|
|Duration|8,16|8,38|8,38|

Selezionando la data di acquisto ad oggi, la scadenza del titolo, il tasso delle cedole del 4,35%, 
il tasso lordo calcolato dal tool e la frequenza di pagamento delle cedole (1=annuale, 2=semestrale, 4=trimestrale) 
abbiamo calcolato una duration perfettamente in linea con quella messa a disposizione da simpletoolsforinvestors.

Continuando con il nostro esempio, a fronte di una duration di 8,16 e un rendimento del 4,44%, 
la duration modificata della nostra obbligazione è 7,81. Questo significa che una variazione dei tassi in aumento dell’1% comporta una diminuzione di prezzo del bond del 7,81%. 
Viceversa una diminuzione dei tassi comporterà un incremento del 7,81%.

Dato che ad oggi il prezzo del BTP sul mercato secondario è di 99,62 significa che un aumento dei tassi di un punto percentuale 
comporterebbe una riduzione del prezzo dell’obbligazione a 99,62 – 99,62 * 7,81% = 91,84

Il vantaggio è che molti tool online ma anche lo stesso sito di Borsa Italiana mettono a disposizione il dato già calcolato, 
senza bisogno di ricorrere a questa formula. 
E’ interessante però sapere il rapporto matematico tra durata e duration, in quanto ci consente di capire come 
la sensibilità di un titolo alla variazione dei tassi non dipenda soltanto dalla sua durata anche da quante cedole paga e da quanto è il suo prezzo attuale di scambio.
